workflows:
  version: 2.1
  build_all:
    jobs:
      - trufflehog
      - test_ci:
          requires:
            - trufflehog
      - build_core:
          requires:
            - test_ci
      - audit_core:
          requires:
            - build_core
      - test_core_generic:
          requires:
            - build_core
      - test_core_language:
          requires:
            - build_core
      - test_core_email:
          requires:
            - build_core
      - test_core_exchange:
          requires:
            - build_core
      - test_core_business_logic:
          requires:
            - build_core
      - build_site:
          requires:
            - build_core
      - audit_site:
          requires:
            - build_site
      - test_site:
          requires:
            - build_site
      - test_browser:
          requires:
            - build_site
      - test_android:
          requires:
            - test_ci
      - build_robot:
          requires:
            - build_core
      - version_change:
          filters:
            branches:
              only: /^\d+\.\d+\.\d+\.\d+$/
          requires:
            - test_ci
            - trufflehog
            - build_core
            - audit_core
            - test_core_generic
            - test_core_language
            - test_core_email
            - test_core_exchange
            - test_core_business_logic
            - build_site
            - audit_site
            - test_site
            - test_browser
            - test_android
            - build_robot
