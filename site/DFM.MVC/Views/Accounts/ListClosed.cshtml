@model AccountsIndexModel
@using DFM.Generic

@{
    ViewBag.Title = MultiLanguage.Dictionary["ClosedAccounts"];
    Layout = "~/Views/Shared/_NoAreaLayout.cshtml";
}

@if (!Model.AccountList.Any())
{ 
    <div class="zero-items">@MultiLanguage.Dictionary["NoClosedAccounts"]</div>
}
else
{ 
        
    <table class="List">

        <tr>
            <th>@MultiLanguage.Dictionary["Name"]</th>
            <th>@MultiLanguage.Dictionary["BeginDate"]</th>
            <th>@MultiLanguage.Dictionary["EndDate"]</th>
            <th colspan="2">@MultiLanguage.Dictionary["Total"]</th>
            <!--th class="todo-column">@MultiLanguage.Dictionary["TODO"]</th-->
        </tr>

        @foreach (var account in Model.AccountList)
        {
	        if (account.EndDate != null)
	        {
		        var endMonth = account.EndDate.Value.Month;
		        var endYear = account.EndDate.Value.Year;
		        var monthReportId = endYear*100 + endMonth;

		        var movesSum = account.Total();
		        var value = (movesSum < 0 ? -movesSum : movesSum).ToMoney(Model.Language);
		        var className = movesSum < 0 ? "out" : "in";

		        var sign = account.Sign();

		        //var reopenLabel = MultiLanguage.Dictionary["Reopen", "Account"];
		        //var reopenUrl = Url.Action("Reopen", new { id = account.Name });

		        <tr>
			        <td>
				        @Html.RouteLink(account.Name, RouteNames.ACCOUNT, new {accounturl = account.Url, controller = "Reports", action = "ShowMoves", id = monthReportId})
			        </td>

			        <td>@account.BeginDate.ToShortDateString()</td>
			        <td>@account.EndDate.ToShortDateString()</td>

			        <td class="numeric @className">@value</td>
			        <td class="account_sign">
				        @if (sign != null)
				        {
					        <img src="/Assets/image/icons/@(sign)_sign.gif" alt="@sign"/>
				        }
			        </td>
			        @*
					<td class="image">
						<a href="@reopenUrl">
							<img src="/Assets/image/icons/reopen.gif" alt="@reopenLabel" title="@reopenLabel" />
						</a>
					</td>
					*@
		        </tr>
	        }
        } 

    </table>
} 
