@using DFM.Entities.Enums
@using DFM.MVC.Models
@model MoveLineModel

@{ var move = Model.Move; }

<tr class="row" id="m@(move.ID)">
	<td>@move.Description</td>

	@if (Model.IsUsingCategories)
	{
		<td class="text-center">@(move.CategoryName ?? "---")</td>
	}

	<td class="text-center">@move.GetDate().ToShortDateString() </td>

	<td class="text-right">
		@if (move.InUrl == Model.CurrentAccountUrl)
		{
			@Html.Partial("ValueWithSign",
				new ValueWithSign(move.Total, Model.Language))
		}
	</td>

	<td class="text-right">
		@if (move.OutUrl == Model.CurrentAccountUrl)
		{
			@Html.Partial("ValueWithSign",
				new ValueWithSign(-move.Total, Model.Language))
		}
	</td>

	@if (Model.CanCheck)
	{
		<td class="text-center">
			<span class="glyphicon glyphicon-@(move.Checked ? "exclamation-sign text-success" : "question-sign text-danger")"
				  title="@Translator.Dictionary[move.Checked ? "Checked" : "Unchecked"]">
			</span>
		</td>
	}

	<td class="col-sm-1 text-center">
		<a href="@Url.Action("Edit", "Moves", new {id = move.ID})">
			<span class="glyphicon glyphicon-edit"
				  title="@Translator.Dictionary["Edit"]">
			</span>
		</a>
	</td>

	<td class="col-sm-1 text-center">
		@Html.Partial("MicroForm",
			MicroForm.WithGlyph("trash", "Delete")
				.AddIdUrl("Moves", "Delete", move.ID)
			)
	</td>

	@if (Model.CanCheck)
	{
		var action = move.Checked ? "Uncheck" : "Check";
		var glyph = move.Checked ? "remove" : "ok";
		var nature = move.OutUrl == Model.CurrentAccountUrl
			? PrimalMoveNature.Out
			: PrimalMoveNature.In;

		<td class="col-sm-1 text-center">
			@Html.Partial("MicroForm",
				MicroForm.WithGlyph(glyph, action)
					.AddIdUrl("Moves", action, move.ID)
					.AddHidden("nature", nature)
					.AsAjax($"m{move.ID}")
				)
		</td>
	}
</tr>
